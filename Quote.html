<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="css/site/styles.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Quote Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <nav class="nav">
            <div class="nav__item">
                <a href="index.html" class="back-link">Back to Tools</a>
            </div>
        </nav>

        <header class="page-header">
            <div>
                <h1 class="page-header__title">Quote Generator</h1>
                <p class="lead">Excel BOM enrichment with supplier API integration</p>
            </div>
            <div class="page-header__meta">
                <div class="meta">Status: <span id="systemStatus">Ready</span></div>
            </div>
        </header>

        <!-- Settings Panel -->
        <section class="mb-48" id="settingsSection">
            <div class="flex justify-between items-center mb-16">
                <h2>Configuration</h2>
                <button id="toggleSettings" class="button button--ghost">Minimize</button>
            </div>
            
            <div id="settingsPanel" class="card">
                <div class="mb-24">
                    <h3 class="mb-16">API Credentials</h3>
                    
                    <!-- Digikey Credentials -->
                    <div class="border-b pb-16 mb-16">
                        <h4 class="font-semibold mb-8">Digikey Credentials</h4>
                        <div class="grid-12 gap-16 mb-16">
                            <div class="col-span-6">
                                <div class="form__group">
                                    <label class="label">Client ID</label>
                                    <input type="text" id="dgClientId" class="input">
                                </div>
                            </div>
                            <div class="col-span-6">
                                <div class="form__group">
                                    <label class="label">Client Secret</label>
                                    <input type="password" id="dgClientSecret" class="input">
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid-12 gap-16 mb-16">
                            <div class="col-span-4">
                                <div class="form__group">
                                    <label class="label">Environment</label>
                                    <select id="dgEnvironment" class="select">
                                        <option value="production">Production</option>
                                        <option value="sandbox">Sandbox</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-span-4">
                                <div class="form__group">
                                    <label class="label">Locale</label>
                                    <select id="dgLocale" class="select">
                                        <option value="US/USD">US / USD</option>
                                        <option value="CA/CAD">CA / CAD</option>
                                        <option value="GB/GBP">GB / GBP</option>
                                        <option value="DE/EUR">DE / EUR</option>
                                        <option value="JP/JPY">JP / JPY</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-span-4">
                                <div class="form__group">
                                    <label class="label">Status</label>
                                    <div class="flex items-center gap-8 mt-8">
                                        <div id="dgStatus" class="status-dot status-dot--inactive"></div>
                                        <span id="dgStatusText" class="text-xs">Inactive</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mouser Credentials -->
                    <div class="border-b pb-16 mb-16">
                        <h4 class="font-semibold mb-8">Mouser Credentials</h4>
                        <div class="grid-12 gap-16 mb-16">
                            <div class="col-span-6">
                                <div class="form__group">
                                    <label class="label">API Key</label>
                                    <input type="password" id="mrApiKey" class="input">
                                </div>
                            </div>
                            <div class="col-span-6">
                                <div class="form__group">
                                    <label class="label">Status</label>
                                    <div class="flex items-center gap-8 mt-8">
                                        <div id="mrStatus" class="status-dot status-dot--inactive"></div>
                                        <span id="mrStatusText" class="text-xs">Inactive</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button id="saveCredentials" class="button button--primary">Save Credentials</button>
                        <button id="testCredentials" class="button button--ghost">Test Connection</button>
                        <button id="clearCredentials" class="button button--ghost text-error">Clear All</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Excel Upload Section -->
        <section class="mb-48">
            <h2 class="mb-16">Excel File Processing</h2>
            
            <div class="card mb-16">
                <div class="form__group">
                    <label class="label">Excel File Upload</label>
                    <input type="file" id="excelFile" accept=".xlsx,.xls" class="input">
                    <div class="form__help">Upload an Excel file to process with supplier data</div>
                </div>
            </div>
            
            <!-- Sheet Selection -->
            <div id="sheetSelection" class="card mb-16 hidden">
                <h3 class="mb-16">Sheet Selection</h3>
                <div class="form__group">
                    <label class="label">Select Sheet</label>
                    <select id="sheetSelect" class="select">
                        <option value="">Choose a sheet...</option>
                    </select>
                </div>
            </div>
            
            <!-- Data Preview -->
            <div id="dataPreview" class="card mb-16 hidden">
                <h3 class="mb-16">Data Preview</h3>
                <div id="previewContainer" class="table-container">
                    <div class="empty">No data to preview</div>
                </div>
            </div>
            
            <!-- Column Mapping -->
            <div id="columnMapping" class="card mb-16 hidden">
                <h3 class="mb-16">Column Mapping</h3>
                
                <div class="alert alert--info mb-16">
                    <div class="alert__msg">Select which columns contain your MPN, Manufacturer, and Quantity data</div>
                </div>
                
                <div class="grid-12 gap-16 mb-24">
                    <div class="col-span-4">
                        <div class="form__group">
                            <label class="label">MPN Column</label>
                            <select id="mpnColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-span-4">
                        <div class="form__group">
                            <label class="label">Manufacturer Column</label>
                            <select id="manufacturerColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-span-4">
                        <div class="form__group">
                            <label class="label">Quantity Column</label>
                            <select id="quantityColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Dynamic Column Addition -->
                <div class="border-t pt-16">
                    <h4 class="mb-16">Add Data Columns</h4>
                    
                    <div id="dynamicColumns" class="space-y-16">
                        <!-- Dynamic columns will be added here -->
                    </div>
                    
                    <button id="addColumn" class="button button--ghost mt-16">Add Column</button>
                </div>
                
                <div class="button-group mt-24">
                    <button id="startProcessing" class="button button--primary" disabled>Start Processing</button>
                </div>
            </div>
        </section>

        <!-- Processing Progress -->
        <section id="processingSection" class="mb-48 hidden">
            <h2 class="mb-16">Processing Progress</h2>
            
            <div class="card">
                <div class="mb-16">
                    <div id="progressText" class="font-mono text-xs mb-8">Initializing...</div>
                    <div class="progress mb-16">
                        <div id="progressBar" class="progress__bar"></div>
                    </div>
                </div>
                
                <div class="stats">
                    <div class="text-center">
                        <div class="stat__value" id="statProcessed">0</div>
                        <div class="stat__label">Processed</div>
                    </div>
                    <div class="text-center">
                        <div class="stat__value" id="statSuccess">0</div>
                        <div class="stat__label">Success</div>
                    </div>
                    <div class="text-center">
                        <div class="stat__value" id="statWarning">0</div>
                        <div class="stat__label">Warning</div>
                    </div>
                    <div class="text-center">
                        <div class="stat__value" id="statError">0</div>
                        <div class="stat__label">Error</div>
                    </div>
                </div>
                
                <div class="mt-16">
                    <button id="cancelProcessing" class="button button--ghost text-error">Cancel Processing</button>
                </div>
            </div>
        </section>

        <!-- Export Section -->
        <section id="exportSection" class="mb-48 hidden">
            <h2 class="mb-16">Export Results</h2>
            
            <div class="card">
                <div class="alert alert--success mb-16">
                    <div class="alert__msg">Processing completed successfully! Your enhanced Excel file is ready for download.</div>
                </div>
                
                <div class="button-group">
                    <button id="downloadExcel" class="button button--primary">Download Enhanced Excel</button>
                    <button id="previewResults" class="button button--ghost">Preview Results</button>
                    <button id="resetTool" class="button button--ghost">Process Another File</button>
                </div>
            </div>
        </section>

        <!-- Results Preview Modal -->
        <div id="previewModal" class="overlay">
            <div class="modal modal--lg">
                <button id="closePreview" class="modal__close button button--ghost">×</button>
                <h3 class="mb-16">Results Preview</h3>
                <div id="previewContent" class="table-container" style="max-height: 400px;">
                    <!-- Preview content will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Log Section -->
        <section class="mb-48">
            <h2 class="mb-16">System Log</h2>
            <div id="systemLog" class="log">Quote Generator initialized - Ready to process Excel files</div>
        </section>
    </div>

    <script src="js/quote/quote-controller.js"></script>
</body>
</html>