<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Advanced Reasoning Lab</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@200;300;400;500;600;700&family=Geist+Mono:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-title">
                <h1>Gemini Advanced Reasoning Lab</h1>
                <p class="header-subtitle">Persistent multi-agent reasoning workspace</p>
            </div>
            <div class="header-actions">
                <div id="freezeStatus" class="freeze-status"></div>
                <button id="freezeBtn" class="btn-secondary">Freeze</button>
                <button id="resetBtn" class="btn-reset">Reset All</button>
            </div>
        </header>

        <div class="warning-banner">
            <strong>Security Notice:</strong> This lab executes JavaScript directly in your browser without isolation. Use only trusted Gemini API keys.
        </div>

        <div class="upgrade-notice" style="background: #e3f2fd; border: 1px solid #90caf9; padding: 12px 16px; margin: 16px 24px; border-radius: 4px; text-align: center;">
            <strong>ðŸ†• Enhanced Version Available!</strong> 
            <a href="enhanced-index.html" style="color: #1976d2; text-decoration: none; font-weight: 500;">Try the new Enhanced Data Vault System â†’</a>
        </div>

        <div class="top-grid">
            <section class="panel">
                <h2>API Keys</h2>
                <div class="api-keys-container">
                    <div class="api-key-group">
                        <input type="password" id="apiKey0" class="api-key-input" placeholder="API Key 1">
                        <span class="key-status" id="keyStatus0"></span>
                    </div>
                    <div class="api-key-group">
                        <input type="password" id="apiKey1" class="api-key-input" placeholder="API Key 2">
                        <span class="key-status" id="keyStatus1"></span>
                    </div>
                    <div class="api-key-group">
                        <input type="password" id="apiKey2" class="api-key-input" placeholder="API Key 3">
                        <span class="key-status" id="keyStatus2"></span>
                    </div>
                    <div class="api-key-group">
                        <input type="password" id="apiKey3" class="api-key-input" placeholder="API Key 4">
                        <span class="key-status" id="keyStatus3"></span>
                    </div>
                    <div class="api-key-group">
                        <input type="password" id="apiKey4" class="api-key-input" placeholder="API Key 5">
                        <span class="key-status" id="keyStatus4"></span>
                    </div>
                </div>
                <div class="model-selector">
                    <label for="modelSelect">Model</label>
                    <select id="modelSelect">
                        <option value="gemini-2.0-flash-exp">gemini-2.0-flash-exp</option>
                        <option value="gemini-1.5-pro">gemini-1.5-pro</option>
                        <option value="gemini-1.5-flash">gemini-1.5-flash</option>
                    </select>
                </div>
            </section>

            <section class="panel">
                <h2>Memories</h2>
                <div id="memoriesContainer" class="scrollable-list">
                    <div class="empty-state">No memories yet</div>
                </div>
            </section>

            <section class="panel">
                <h2>Goals</h2>
                <div id="goalsContainer" class="scrollable-list">
                    <div class="empty-state">No goals yet</div>
                </div>
                <div class="goal-input-group">
                    <input type="text" id="goalInput" placeholder="Add a goal...">
                    <button id="addGoalBtn" class="btn-small">Add</button>
                </div>
            </section>
        </div>

        <div class="middle-grid">
            <section class="panel tasks-panel">
                <div class="panel-header">
                    <h2>Task List</h2>
                    <p class="panel-subtitle">Freeze, adjust, and resume without losing the execution state.</p>
                </div>
                <div id="tasksContainer" class="scrollable-list">
                    <div class="empty-state">No tasks defined</div>
                </div>
            </section>

            <section class="panel reasoning-panel">
                <div class="panel-header">
                    <h2>Reasoning Chain</h2>
                    <span id="statusIndicator" class="status-indicator"></span>
                </div>
                <div id="reasoningContainer" class="scrollable-content">
                    <div class="empty-state">Awaiting user input to begin reasoning...</div>
                </div>
            </section>
        </div>

        <div class="secondary-grid">
            <section class="panel code-panel">
                <h2>Code Execution Output</h2>
                <div id="codeOutputContainer" class="scrollable-content code-output">
                    <div class="empty-state">No code executed yet</div>
                </div>
            </section>

            <section class="panel vault-panel">
                <h2>Data Vault</h2>
                <p class="panel-subtitle">Large outputs are stored as reusable references.</p>
                <div id="vaultContainer" class="scrollable-content vault-list">
                    <div class="empty-state">No stored data yet</div>
                </div>
            </section>
        </div>

        <section class="panel canvas-panel">
            <h2>Canvas Outputs</h2>
            <div id="canvasContainer" class="canvas-container">
                <div class="empty-state">No canvas output yet</div>
            </div>
        </section>

        <section class="panel chat-panel">
            <h2>Chat Interface</h2>
            <div id="chatContainer" class="scrollable-content chat-messages"></div>
            <div class="chat-input-group">
                <textarea id="chatInput" placeholder="Type your message..." rows="3"></textarea>
                <button id="sendBtn" class="btn-primary">Send</button>
            </div>
        </section>
    </div>

    <div id="taskModal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>Edit Task</h3>
                <button type="button" class="modal-close" id="taskModalClose" aria-label="Close task editor">&times;</button>
            </div>
            <form id="taskModalForm" class="modal-body">
                <label class="field">
                    <span>Description</span>
                    <input type="text" id="taskDescriptionInput" required>
                </label>
                <label class="field">
                    <span>Status</span>
                    <select id="taskStatusSelect">
                        <option value="pending">Pending</option>
                        <option value="ongoing">Ongoing</option>
                        <option value="complete">Complete</option>
                    </select>
                </label>
                <label class="field">
                    <span>Notes</span>
                    <textarea id="taskNotesInput" rows="4" placeholder="Add notes or vault references..."></textarea>
                </label>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" data-modal-dismiss="task">Cancel</button>
                <button type="button" class="btn-primary" id="taskModalSave">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="vaultModal" class="modal modal--wide">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>Stored Data Preview</h3>
                <button type="button" class="modal-close" id="vaultModalClose" aria-label="Close data preview">&times;</button>
            </div>
            <div class="modal-body" id="vaultModalBody"></div>
        </div>
    </div>

    <!-- Load shared dependencies first -->
    <script type="module" src="storage.js"></script>
    <script type="module" src="gemini-api.js"></script>
    <!-- Load enhanced system components -->
    <script type="module" src="data-vault-enhanced.js"></script>
    <script type="module" src="vault-tag-processor.js"></script>
    <script type="module" src="vault-llm-procedures.js"></script>
    <script type="module" src="tool-executor-enhanced.js"></script>
    <script type="module" src="ui-manager.js"></script>
    <!-- Load main entry point -->
    <script type="module" src="main.js"></script>
</body>
</html>