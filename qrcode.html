<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Component Scanner â€” Alica Technologies</title>
    <link rel="stylesheet" href="css/site/styles.css">
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <nav class="nav">
            <div class="nav__item">
                <a href="index.html" class="back-link">Back to Tools</a>
            </div>
        </nav>

        <!-- Page Header -->
        <header class="page-header">
            <div>
                <h1 class="page-header__title">QR Code Component Scanner</h1>
                <p class="lead">Rapid component counting and BOM matching through QR/barcode scanning</p>
            </div>
            <div class="page-header__meta">
                <div class="status-indicator">
                    <span class="status-dot status-dot--success"></span>
                    <span>STATUS: <span id="scannerStatus" class="badge badge--success">READY</span></span>
                </div>
                <div class="meta">SCANNED: <span id="scanCount" class="font-mono">0</span></div>
                <div class="meta">MATCHED: <span id="matchCount" class="font-mono">0</span></div>
            </div>
        </header>

        <!-- Step Progress Indicator -->
        <div class="step-indicator">
            <div class="step-indicator__item is-current">
                <div class="step-indicator__number">1</div>
                <span>Import File</span>
            </div>
            <div class="step-indicator__separator"></div>
            <div class="step-indicator__item">
                <div class="step-indicator__number">2</div>
                <span>Select Sheet</span>
            </div>
            <div class="step-indicator__separator"></div>
            <div class="step-indicator__item">
                <div class="step-indicator__number">3</div>
                <span>Data Range</span>
            </div>
            <div class="step-indicator__separator"></div>
            <div class="step-indicator__item">
                <div class="step-indicator__number">4</div>
                <span>Map Columns</span>
            </div>
            <div class="step-indicator__separator"></div>
            <div class="step-indicator__item">
                <div class="step-indicator__number">5</div>
                <span>Scanner</span>
            </div>
        </div>

        <!-- Step 1: File Import -->
        <section class="mb-48">
            <div class="card">
                <div class="card__header">
                    <h2 class="card__title">Step 1: Import Excel File</h2>
                </div>
                <div>
                    <div class="form__group">
                        <label class="label">Select Excel File (.xlsx, .xls)</label>
                        <input type="file" id="excelFile" accept=".xlsx,.xls" class="input" />
                        <div class="form__help">Upload your BOM Excel file to begin the scanning process</div>
                    </div>

                    <div id="fileInfo" class="file-info-panel hidden">
                        <h3>File Information</h3>
                        <div class="kv">
                            <div class="kv__pair">
                                <div class="kv__key">File Name</div>
                                <div class="kv__val" id="fileName"></div>
                            </div>
                            <div class="kv__pair">
                                <div class="kv__key">File Size</div>
                                <div class="kv__val" id="fileSize"></div>
                            </div>
                            <div class="kv__pair">
                                <div class="kv__key">Sheets Found</div>
                                <div class="kv__val" id="sheetCount"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 2: Sheet Selection -->
        <section id="step2" class="mb-48 hidden">
            <div class="card">
                <div class="card__header">
                    <h2 class="card__title">Step 2: Select Sheet</h2>
                </div>
                <div>
                    <div class="form__group">
                        <label class="label">Available Sheets</label>
                        <select id="sheetSelect" class="select">
                            <option value="">Select a sheet...</option>
                        </select>
                        <div class="form__help">Choose the sheet containing your BOM data</div>
                    </div>

                    <div id="sheetPreview" class="mt-24 hidden">
                        <h3 class="mb-16">Sheet Preview (First 10 rows)</h3>
                        <div class="table-container">
                            <div id="previewTable"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 3: Data Range Selection -->
        <section id="step3" class="mb-48 hidden">
            <div class="card">
                <div class="card__header">
                    <h2 class="card__title">Step 3: Select Data Range</h2>
                </div>
                <div>
                    <div class="alert alert--info mb-24">
                        <div class="alert__msg">
                            <strong>Desktop:</strong> Click and drag to select the data range.<br>
                            <strong>Mobile:</strong> Enable click selection mode, then tap two cells to define range corners.
                        </div>
                    </div>

                    <div class="grid-12 gap-16 mb-24">
                        <div class="col-span-6">
                            <div class="form__group">
                                <label class="label">Start Cell</label>
                                <input type="text" id="startCell" placeholder="A1" class="input" />
                            </div>
                        </div>
                        <div class="col-span-6">
                            <div class="form__group">
                                <label class="label">End Cell</label>
                                <input type="text" id="endCell" placeholder="F100" class="input" />
                            </div>
                        </div>
                    </div>

                    <div class="mb-24">
                        <div class="table-container zoom-container" style="max-height: 500px; overflow: auto; border: 1px solid var(--color-gray-200, #e5e5e5); background: var(--color-white, #fff);">
                            <div id="selectableTable"></div>
                        </div>
                    </div>

                    <div class="button-group">
                        <button id="confirmRange" class="button button--primary" disabled>CONFIRM SELECTION</button>
                        <button id="clearRange" class="button button--ghost">CLEAR SELECTION</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 4: Column Mapping -->
        <section id="step4" class="mb-48 hidden">
            <div class="card">
                <div class="card__header">
                    <h2 class="card__title">Step 4: Map Data Columns</h2>
                </div>
                <div>
                    <div class="alert alert--info mb-24">
                        <div class="alert__msg">
                            Map your Excel columns to the required BOM fields. The Target Column will be used for QR/barcode matching.
                        </div>
                    </div>

                    <div class="mapping-grid mb-24">
                        <div class="form__group">
                            <label class="label">Serial No. Column</label>
                            <select id="serialColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>

                        <div class="form__group">
                            <label class="label">MPN Column</label>
                            <select id="mpnColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>

                        <div class="form__group">
                            <label class="label">Designators Column</label>
                            <select id="designatorsColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>

                        <div class="form__group">
                            <label class="label">Manufacturer Column</label>
                            <select id="manufacturerColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>

                        <div class="form__group">
                            <label class="label">Quantity Column</label>
                            <select id="quantityColumn" class="select">
                                <option value="">Select column...</option>
                            </select>
                        </div>

                        <div class="form__group">
                            <label class="label">Target Column (for scanning)</label>
                            <select id="targetColumn" class="select">
                                <option value="">Select target column...</option>
                            </select>
                            <div class="form__help">This column will be matched against scanned QR/barcode values</div>
                        </div>
                    </div>

                    <div class="button-group">
                        <button id="confirmMapping" class="button button--primary" disabled>START SCANNER</button>
                        <button id="backToRange" class="button button--ghost">BACK TO RANGE SELECTION</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 5: Scanner Interface -->
        <section id="step5" class="mb-48 hidden">
            <div class="card mb-24">
                <div class="card__header">
                    <h2 class="card__title">Step 5: QR/Barcode Scanner</h2>
                </div>
            </div>

            <!-- Scanner Layout -->
            <div class="scanner-section">
                <div class="grid-12 gap-24 mb-24">
                    <!-- Scanner Area -->
                    <div class="col-span-8">
                        <div class="scanner-container">
                            <div id="qr-reader" class="camera-preview">
                                <div class="scanner-placeholder">
                                    <p>CLICK START CAMERA TO BEGIN SCANNING</p>
                                </div>
                            </div>
                            <div class="scan-overlay" id="scanOverlay"></div>
                            <!-- Serial Number Overlay -->
                            <div class="serial-overlay" id="serialOverlay">
                                <span class="serial-label">MATCHED COMPONENT</span>
                                <span class="serial-value" id="serialValue">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Controls Panel -->
                    <div class="col-span-4">
                        <div class="card mb-16">
                            <div class="card__header">
                                <h3 class="card__title">Scanner Controls</h3>
                            </div>
                            <div>
                                <div class="scan-controls">
                                    <div class="button-group mb-16">
                                        <button id="startCamera" class="button button--primary button--sm">START CAMERA</button>
                                        <button id="stopCamera" class="button button--ghost button--sm" disabled>STOP CAMERA</button>
                                    </div>
                                    <div class="button-group mb-16">
                                        <button id="switchCamera" class="button button--ghost button--sm" disabled>SWITCH CAMERA</button>
                                    </div>

                                    <div class="form__group">
                                        <label class="label">Camera Selection</label>
                                        <select id="cameraSelect" class="select" disabled>
                                            <option value="">Loading cameras...</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Current Match Display -->
                        <div class="card">
                            <div class="card__header">
                                <h3 class="card__title">Current Match</h3>
                            </div>
                            <div>
                                <div class="scan-result">
                                    <div id="currentMatch" class="empty">NO SCAN RESULTS YET</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics Card -->
            <div class="results-section">
                <div class="card mb-24">
                    <div class="card__header">
                        <h3 class="card__title">Scanning Statistics</h3>
                    </div>
                    <div>
                        <div class="stats">
                            <div class="text-center">
                                <div class="stat__value" id="totalScanned">0</div>
                                <div class="stat__label">TOTAL SCANNED</div>
                            </div>
                            <div class="text-center">
                                <div class="stat__value" id="successMatches">0</div>
                                <div class="stat__label">SUCCESSFUL MATCHES</div>
                            </div>
                            <div class="text-center">
                                <div class="stat__value" id="scanRate">0.0/MIN</div>
                                <div class="stat__label">SCAN RATE</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="card mb-24">
                    <div class="card__header">
                        <h3 class="card__title">Actions</h3>
                    </div>
                    <div>
                        <div class="button-group">
                            <button id="exportResults" class="button button--primary" disabled>EXPORT RESULTS</button>
                            <button id="clearResults" class="button button--ghost">CLEAR RESULTS</button>
                            <button id="resetScanner" class="button button--ghost">RESET ALL</button>
                        </div>
                    </div>
                </div>

                <!-- Scan Results Table -->
                <div class="card">
                    <div class="card__header">
                        <h3 class="card__title">Scan Results</h3>
                    </div>
                    <div>
                        <div class="table-container">
                            <div id="scanResults" class="empty">NO SCAN RESULTS TO DISPLAY</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Load Libraries -->
    <script src="js/qrcode/libs/xlsx.full.min.js"></script>
    <script src="js/qrcode/libs/html5-qrcode.min.js"></script>

    <!-- Load Application Modules -->
    <script src="js/qrcode/config.js"></script>
    <script src="js/qrcode/utils.js"></script>
    <script src="js/qrcode/excel-handler.js"></script>
    <script src="js/qrcode/range-selector.js"></script>
    <script src="js/qrcode/scanner-manager.js"></script>
    <script src="js/qrcode/data-manager.js"></script>
    <script src="js/qrcode/display/text-manager.js"></script>
    <script src="js/qrcode/display/zoom-manager.js"></script>
    <script src="js/qrcode/navigation/step-manager.js"></script>
    <script src="js/qrcode/main.js"></script>
</body>
</html>